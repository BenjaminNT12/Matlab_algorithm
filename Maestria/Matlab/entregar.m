clear all
clc
cla
b1 = 2;
b2 = 2;
j1 = 3;
j2 = 4;
k = 2;
x1 = 1;
x2 = 1;
x3 = 1;
x4 = 1;

h2=0.5;
x0=0:2:4
x4=0;
y1(1) = 0;
y2(1) = ((-b2/j2)*x4)-k*(x3-x1);
y3(1) = x4;
y4(1) = ((-b1/j1)*x2)-k*(x1-x3);

for i2=1:length(x0)
    k11(i2)=y1(i2);
    k12(i2)=((-b2/j2)*x4)-k*(x3-x1);
    k13(i2)=y3(i2);
    k14(i2)=((-b1/j1)*x2)-k*(x1-x3);
    
    k21(i2)=(y1(i2)+(1/2*k11(i2)*h2));
    k22(i2)=(y2(i2)+(1/2*k12(i2)*h2));
    k23(i2)=(y3(i2)+(1/2*k13(i2)*h2));
    k24(i2)=(y4(i2)+(1/2*k14(i2)*h2));
    
    k31(i2)=y1(i2)+(1/2*k21(i2)*h2)+(2*k21(i2)*h2);
    k32(i2)=y2(i2)+(1/2*k22(i2)*h2)+(2*k22(i2)*h2);
    k33(i2)=y3(i2)+(1/2*k23(i2)*h2)+(2*k23(i2)*h2);
    k34(i2)=y4(i2)+(1/2*k24(i2)*h2)+(2*k24(i2)*h2);
    
    k41(i2)=(y1(i2)+(k31(i2)*h2));
    k42(i2)=(y2(i2)+(k32(i2)*h2));
    k43(i2)=(y3(i2)+(k33(i2)*h2));
    k44(i2)=(y4(i2)+(k34(i2)*h2));
    
    if i2<length(x0)
        y1(i2+1)=y1(i2)+(1/6*(k11(i2)+(2*k21(i2))+(2*k31(i2))+k41(i2))*h2);
        y2(i2+1)=y2(i2)+(1/6*(k12(i2)+(2*k22(i2))+(2*k32(i2))+k42(i2))*h2);
        y3(i2+1)=y3(i2)+(1/6*(k13(i2)+(2*k23(i2))+(2*k33(i2))+k43(i2))*h2);
        y4(i2+1)=y4(i2)+(1/6*(k14(i2)+(2*k24(i2))+(2*k34(i2))+k44(i2))*h2);
    else
        break
    end

end
figure(1)
hold on
plot(x0,y1,'r--')
plot(x0,y2,'c--')
plot(x0,y3,'b--')
plot(x0,y4,'y--')
